<!-- SPDX-FileCopyrightText: © 2023 그림또따 <is2you246@gmail.com>
SPDX-License-Identifier: MIT -->

<ion-header>
  <ion-toolbar>
    <ion-title>{{lang.text['Settings']['Title']}}</ion-title>
    <ion-buttons slot="start" (click)="go_back()">
      <ion-back-button defaultHref="main"></ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div [hidden]="isAdHiding">
    <ion-item-divider>
      <ion-label>{{lang.text['Settings']['CommunityAds']}}</ion-label>
      <ion-button slot="end" (click)="open_link('https://is2you2.github.io/')" fill="clear" shape="round">
        {{lang.text['Settings']['AdsContact']}}
      </ion-button>
    </ion-item-divider>
    <div id="advertise" class="advertise_banner"></div>
  </div>
  <ion-item-divider>
    <ion-label>{{lang.text['Settings']['UserInfo']}}</ion-label>
  </ion-item-divider>
  <ion-item button (click)="go_to_page('profile')">
    <div class="additional_form bg_img_form">
      <img class="profile_img" [style]="profile_filter" [src]="nakama.users.self['img']">
    </div>
    <ion-label>{{lang.text['Settings']['myInfo']}}</ion-label>
  </ion-item>
  <ion-item button [disabled]="statusBar.settings['communityServer'] != 'online'" (click)="go_to_page('link-account')">
    <ion-label>{{lang.text['Settings']['takeOverUser']}}</ion-label>
  </ion-item>
  <ion-item-divider>
    <ion-label>{{lang.text['Settings']['ManageServer']}}</ion-label>
  </ion-item-divider>
  <ion-item button (click)="go_to_page('group-server')">
    <div class="additional_form status_bar_single"
      [style]="'background-color: ' + statusBar.colors[statusBar.settings['groupServer']]"></div>
    <ion-label class=" form_margin">{{lang.text['Settings']['groupServer']}}</ion-label>
  </ion-item>
  <ion-item button (click)="go_to_page('community-server')">
    <div class="additional_form status_bar_single"
      [style]="'background-color: ' + statusBar.colors[statusBar.settings['communityServer']]"></div>
    <ion-label class=" form_margin">{{lang.text['Settings']['commServer']}}</ion-label>
    <ion-label *ngIf="client.address_override" class="ion-text-right" color="medium">{{client.address_override}}
    </ion-label>
  </ion-item>
  <ion-item button (click)="go_to_page('dedicated-settings')" *ngIf="!cant_dedicated">
    <div class="additional_form status_bar_single"
      [style]="'background-color: ' + statusBar.colors[statusBar.settings['dedicatedServer']]"></div>
    <ion-label class="form_margin">{{lang.text['Settings']['useDeviceAsServer']}}</ion-label>
  </ion-item>
  <ion-item-divider>
    <ion-label>{{lang.text['Settings']['ManageGroup']}}</ion-label>
  </ion-item-divider>
  <ion-item button (click)="go_to_page('add-group')" [disabled]="statusBar.settings['groupServer'] != 'online'">
    <ion-label>{{lang.text['Settings']['CreateGroup']}}</ion-label>
  </ion-item>
  <ion-item button *ngFor="let group of groups; index as i" (click)="go_to_group_detail(i)">
    <div class="additional_form status_bar_single"
      [style]="'background-color: ' + statusBar.colors[(group['status'] || 'offline')]">
    </div>
    <div class="additional_form bg_img_form">
      <img class="profile_img"
        [style]="'filter: ' + (group['status'] == 'online' ? 'grayscale(0) contrast(1);' : 'grayscale(.9) contrast(1.4);')"
        [src]="group['img']">
    </div>
    <ion-label class="form_margin">
      <p>{{group['server']['name'] + ' (' + group['server']['target'] + ')'}}</p>
      <h2>{{group['name']}}</h2>
    </ion-label>
  </ion-item>
  <ion-item-divider>
    <ion-label>{{lang.text['Settings']['Community']}}</ion-label>
  </ion-item-divider>
  <ion-item button [disabled]="will_enter" (click)="start_minimalchat()">
    <div class="additional_form status_bar_single"
      [style]="'background-color: ' + statusBar.colors[statusBar.settings['community_ranchat']]"></div>
    <ion-label class="form_margin">{{lang.text['Settings']['joinRanchat']}}</ion-label>
  </ion-item>
  <ion-item button [disabled]="will_enter">
    <div class="additional_form status_bar_single"
      [style]="'background-color: ' + statusBar.colors[statusBar.settings['dedicated_groupchat']]"></div>
    <ion-label class="form_margin">{{lang.text['Settings']['joinDediChat']}}</ion-label>
    <ion-input class="ion-text-center" [placeholder]="lang.text['Settings']['joinDedi_placeholder'] + ': 127.0.0.1'"
      [(ngModel)]="chat_address"></ion-input>
    <ion-button (click)="start_minimalchat(chat_address ? 'ws://' + chat_address : 'ws://127.0.0.1')">
      {{lang.text['Settings']['joinDedi_button']}}
    </ion-button>
  </ion-item>
  <div *ngIf="client.is_admin">
    <ion-item-divider>
      <ion-label>{{lang.text['Settings']['admin_community_menu']}}</ion-label>
    </ion-item-divider>
    <ion-item button (click)="go_to_page('notification')">
      <ion-label>{{lang.text['Settings']['admin_noti_all']}}</ion-label>
    </ion-item>
  </div>
  <div *ngIf="!cant_dedicated && !isBatteryOptimizationsShowed">
    <ion-item-divider>
      <ion-label>{{lang.text['Settings']['notifications']}}</ion-label>
    </ion-item-divider>
    <!-- <ion-item button (click)="go_to_page('send-act')">
      <ion-label>송신 동작</ion-label>
    </ion-item>
    <ion-item button (click)="go_to_page('receive-act')">
      <ion-label>수신 동작</ion-label>
    </ion-item> -->
    <div *ngIf="!cant_dedicated && !isBatteryOptimizationsShowed">
      <ion-item button (click)="setDisableBatteryOptimizations()">
        <ion-label>{{lang.text['Settings']['batteryOptimization']}}</ion-label>
      </ion-item>
    </div>
  </div>
  <div *ngIf="list_tools.length">
    <ion-item-divider>
      <ion-label>{{lang.text['Settings']['ToolManage']}}</ion-label>
    </ion-item-divider>
    <ion-item button (click)="go_to_tool_list()">
      <ion-label>{{lang.text['Settings']['ToolList']}}</ion-label>
    </ion-item>
  </div>
  <ion-item-divider>
    <ion-label>{{lang.text['Settings']['AppInfo']}}</ion-label>
  </ion-item-divider>
  <ion-item button (click)="go_to_page('creator')">
    <ion-label>{{lang.text['Settings']['AppCreator']}}</ion-label>
  </ion-item>
  <ion-item *ngIf="lang.lang != 'ko'" button (click)="go_to_page('translator')">
    <ion-label>{{lang.text['Settings']['AppTranslator']}}</ion-label>
  </ion-item>
  <ion-item button (click)="LangClicked()">
    <ion-icon slot="start" name="language"></ion-icon>
    <ion-label>{{lang.text['Settings']['AppLanguage']}}</ion-label>
    <ion-select #LangSel style="pointer-events: none;" [value]="lang.lang" [placeholder]="lang.lang"
      (ionChange)="LanguageChanged($event)">
      <ion-select-option *ngIf="client.is_admin" value="#">#</ion-select-option>
      <ion-select-option value="en">English</ion-select-option>
      <ion-select-option value="ko">한국어</ion-select-option>
    </ion-select>
  </ion-item>
  <ion-item button (click)="go_to_page('privacy')">
    <ion-label>{{lang.text['Settings']['userPrivacyTerms']}}</ion-label>
  </ion-item>
  <ion-item button (click)="go_to_page('licenses')">
    <ion-label>{{lang.text['Settings']['LicenseNotice']}}</ion-label>
  </ion-item>
  <ion-item disabled button (click)="open_link('https://is2you2.github.io/')">
    <ion-label>{{lang.text['Settings']['UserGuideLink']}}</ion-label>
  </ion-item>
</ion-content>