<!-- SPDX-FileCopyrightText: © 2023 그림또따 <is2you246@gmail.com>
SPDX-License-Identifier: MIT -->

<ion-header>
  <ion-toolbar id="Toolbar">
    <ion-title>{{lang.text['ContentViewer']['Title']}}</ion-title>
    <ion-buttons slot="start" (click)="modalCtrl.dismiss()">
      <ion-back-button defaultHref=""></ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content id="ContentBox">
  <table class="main_table_elt">
    <tr style="height: 0;">
      <td>
        <ion-list-header id="FileHeader">
          <ion-label text-wrap>{{FileInfo.filename}}</ion-label>
          <ion-button id="menu_trigger">
            <ion-icon slot="start" style="transform: translateX(25%);" name="ellipsis-vertical"></ion-icon>
          </ion-button>
          <ion-popover trigger="menu_trigger" dismissOnSelect>
            <ng-template>
              <ion-content>
                <ion-list>
                  <ion-item button *ngIf="FileInfo['viewer'] == 'image' && !HasNoEditButton" (click)="modify_image()">
                    <ion-label>{{lang.text['ContentViewer']['Edit']}}</ion-label>
                  </ion-item>
                  <ion-item button *ngIf="FileInfo['content_creator']" id="ShowContentInfoIonic">
                    <ion-label>{{lang.text['ContentViewer']['ContentInfo']}}</ion-label>
                  </ion-item>
                  <ion-item button (click)="ShareContent()">
                    <ion-label>{{lang.text['ContentViewer']['ShareContent']}}</ion-label>
                  </ion-item>
                  <ion-item button (click)="download_file()">
                    <ion-label>{{lang.text['ContentViewer']['Download']}}</ion-label>
                  </ion-item>
                </ion-list>
              </ion-content>
            </ng-template>
          </ion-popover>
        </ion-list-header>
      </td>
    </tr>
    <tr>
      <td>
        <div class="full_screen" style="overflow-y: scroll;" id="p5canvas"></div>
      </td>
    </tr>
  </table>

  <ion-modal trigger="ShowContentInfoIonic" [initialBreakpoint]=".5" [breakpoints]="[.5, .6, .7, .8, .9, 1]">
    <ng-template>
      <ion-content>
        <ion-item-divider>
          <ion-label>{{lang.text['ContentInfo']['WorkLogs']}}</ion-label>
        </ion-item-divider>
        <ion-item>
          <ion-label>{{lang.text['ContentInfo']['LastPost']}}</ion-label>
          <ion-label class="ion-text-end">
            {{content_creator.user_id ? (content_creator.is_me ? nakama.users.self['display_name'] :
            nakama.users[isOfficial][target][content_creator.user_id]['display_name'])
            : content_creator.display_name}}</ion-label>
        </ion-item>
        <ion-item *ngIf="content_creator.various">
          <ion-label>{{lang.text['ContentInfo']['SourceFrom']}}</ion-label>
          <ion-label class="ion-text-end"
            *ngIf="content_creator.various == 'loaded'">{{lang.text['GlobalAct']['variousCreator']}}</ion-label>
          <ion-label class="ion-text-end"
            *ngIf="content_creator.various == 'camera'">{{lang.text['GlobalAct']['FromCamera']}}</ion-label>
          <ion-label class="ion-text-end"
            *ngIf="content_creator.various == 'voidDraw'">{{lang.text['GlobalAct']['FromVoidDraw']}}</ion-label>
        </ion-item>
        <ion-item>
          <ion-label>{{lang.text['ContentInfo']['TimeAt']}}</ion-label>
          <ion-label class="ion-text-end">{{content_creator.timeDisplay}}</ion-label>
        </ion-item>
        <div *ngFor="let worker of content_related_creator">
          <ion-item-divider>
            <div style="width: 100%; text-align: center;">{{worker.timeDisplay}}</div>
          </ion-item-divider>
          <ion-item>
            <ion-label>{{lang.text['ContentInfo']['Publisher']}}</ion-label>
            <ion-label class="ion-text-end">{{worker.publisher || worker.display_name}}</ion-label>
          </ion-item>
          <ion-item>
            <ion-label>{{lang.text['ContentInfo']['SourceFrom']}}</ion-label>
            <ion-label class="ion-text-end"
              *ngIf="worker.various == 'loaded'">{{lang.text['GlobalAct']['variousCreator']}}</ion-label>
            <ion-label class="ion-text-end"
              *ngIf="worker.various == 'camera'">{{lang.text['GlobalAct']['FromCamera']}}</ion-label>
            <ion-label class="ion-text-end"
              *ngIf="worker.various == 'voidDraw'">{{lang.text['GlobalAct']['FromVoidDraw']}}</ion-label>
          </ion-item>
        </div>
      </ion-content>
    </ng-template>
  </ion-modal>
</ion-content>